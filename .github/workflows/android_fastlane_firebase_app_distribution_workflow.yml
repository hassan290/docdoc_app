name: Android Fastlane Firebase App Distribution Workflow
on:
    push:
        branches:
            - master
jobs:
    distribute_to_firebase:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4.1.7
            - name: Set up Java JDK
              uses: actions/setup-java@v4.3.0
              with:
                  distribution: 'temurin'
                  java-version: '11'
            - name: Install Flutter
              uses: subosito/flutter-action@v2.14.0
              with:
                  channel: 'stable'
            - name: Setup Ruby
              uses: ruby/setup-ruby-pkgs@v1.33.2
              with:
                  ruby-version: '3.2.3'
                  bundler-cache: true
                  working-directory: 'android'
            - name: Build and distribute app
              env:
                FIREBASE_CLI_TOKEN: ${{ secrets.FIREBASE_CLI_TOKEN }}
              run: |
                bundle exec fastlane android firebase_distribution
              working-directory: 'android'
